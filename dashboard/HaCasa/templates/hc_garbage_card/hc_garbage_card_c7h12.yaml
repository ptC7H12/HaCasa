hc_garbage_card_c7h12:
  variables:
    static_text: Tage bis zur Abholung von
    trash_entities:
      - days: sensor.restmull
        name: Restmüll
        icon: far:trash-can
        color: rgba (123, 123, 123, 1)
      - days: sensor.papierbehalter
        name: Papiermüll
        icon: far:newspaper
        color: rgba (141, 174, 202, 1)
      - days: sensor.wertstofftonne
        name: Wertstoff
        icon: fas:recycle
        color: rgba(151, 207, 201, 1)
    "y": |
      [[[
        // Definiere die Entitäten für Müllabholungen
        const trashData = variables.trash_entities.map(entity => ({
          days: entity.days,
          name: entity.name,
          icon: entity.icon,
          color: entity.color,
          days_left: states[entity.days] ? parseInt(states[entity.days].state, 10) : 0
        }));

        // Sort array based on the left days: variable.days
        trashData.sort((a, b) => a.days_left - b.days_left);

        return JSON.stringify(trashData); // Als String zurückgeben
      ]]]
  show_name: false
  show_icon: true
  show_label: true
  show_state: false
  tap_action: none
  icon: |
    [[[
      const trashData = JSON.parse(variables.y); // JSON zurück in ein Array umwandeln
      const first = trashData[0];
      return first ? first.icon : null;
    ]]]
  label: |
    [[[
      const trashData = JSON.parse(variables.y);
      const first = trashData[0];
      if (!first) return 'n/a';
      
      return `${first.days_left}`;
    ]]]
  styles:
    grid:
      - grid-template-areas: |
          'i l middle next'
      - grid-template-columns: 15% 10% auto 25%
      - column-gap: 0%
    card:
      - height: auto
      - padding: 10px
    img_cell:
      - left: 0%
      - width: 6rem
      - height: 6rem
      - padding-left: 10px
      - padding-right: 10px
    icon:
      - width: 4rem
      - color: |
          [[[
            const trashData = JSON.parse(variables.y);
            const first = trashData[0];
            return first ? first.color : null;
          ]]]
    label:
      - font-size: 4rem
      - font-family: Montserrat
      - font-weight: 700
    custom_fields:
      next:
        - justify-self: end
        - padding-right: 5px
  custom_fields:
    middle:
      card:
        type: custom:button-card
        tap_action: none
        show_name: true
        show_icon: false
        show_label: true
        show_state: false
        name: |
          [[[
            const trashData = JSON.parse(variables.y);
            const first = trashData[0];
            return first ? first.name : '';
          ]]]
        label: |
          [[[
            return variables.static_text ? variables.static_text : "days until pickup"
          ]]]
        styles:
          grid:
            - grid-template-areas: |
                'l'
                'n'
            - grid-template-rows: 1fr 1.7fr
            - row-gap: 0px
          card:
            - box-shadow: none
            - background: none
            - height: auto
            - padding: 0px 10px 0px 10px
            - margin: 0px
          label:
            - font-size: 1rem
            - font-family: Montserrat
            - font-weight: 400
            - justify-self: start
            - align-self: end
          name:
            - font-size: 2.3rem
            - font-family: Montserrat
            - font-weight: 600
            - justify-self: start
            - align-self: start
    next:
      card:
        type: custom:button-card
        tap_action: none
        styles:
          grid:
            - grid-template-areas: |
                'second'
                'third'
            - grid-template-rows: 1fr 1fr
            - row-gap: 5px
          card:
            - padding: 0px
            - box-shadow: none
        custom_fields:
          second:
            card:
              type: custom:button-card
              show_name: true
              show_icon: true
              show_label: true
              show_state: false
              styles: &stylenext
                card:
                  - box-shadow: none
                  - background: none
                  - padding: 4px 10px
                grid:
                  - grid-template-areas: |
                      'i n'
                      'i l'
                  - grid-template-columns: min-content 1fr
                  - grid-template-rows: min-content 1fr
                  - row-gap: 2px
                name:
                  - font-size: 0.6rem
                  - font-family: Montserrat
                  - justify-self: start
                img_cell:
                  - padding-right: 5px
                icon:
                  - width: 1.2rem
                label:
                  - font-size: 0.8rem
                  - font-family: Montserrat
                  - font-weight: 700
                  - justify-self: start
              name: |
                [[[
                  const trashData = JSON.parse(variables.y);
                  const first = trashData[1];
                  return first ? first.name : '';
                ]]]
              label: |
                [[[
                  const trashData = JSON.parse(variables.y);
                  const first = trashData[1];
                  if (!first) return '';
                  
                  return `${first.days_left} Tage`;
                ]]]
              icon: |
                [[[
                  const trashData = JSON.parse(variables.y); // JSON zurück in ein Array umwandeln
                  const first = trashData[1];
                  return first ? first.icon : null;
                ]]]
          third:
            card:
              type: custom:button-card
              show_name: true
              show_icon: true
              show_label: true
              show_state: false
              name: |
                [[[
                  const trashData = JSON.parse(variables.y);
                  const first = trashData[2];
                  return first ? first.name : '';
                ]]]
              label: |
                [[[
                  const trashData = JSON.parse(variables.y);
                  const first = trashData[2];
                  if (!first) return '';
                  
                  return `${first.days_left} Tage`;
                ]]]
              icon: |
                [[[
                  const trashData = JSON.parse(variables.y); // JSON zurück in ein Array umwandeln
                  const first = trashData[2];
                  return first ? first.icon : null;
                ]]]
              styles: *stylenext
